import{d as D,r as w,e as a,o as _,n as S,g as t,f as e,h as v,m as J,a as R,t as r,k as B,q as K,w as j,c as $,l as h,p as X,v as Y,_ as G,F as P,A as Z,i as W,j as ee,D as te,E as ae}from"./index-DZj9jcQQ.js";import{a as Q,u as M}from"./useQuery-VCkO930N.js";import{u as oe,C as le}from"./dashboard-store-B4gS3aw7.js";import{a as L}from"./api-client-BYJOZBEW.js";import{S as ne}from"./StudentService-D9_mIzmb.js";import"./base-url-qR72hEjy.js";const se={class:"text-h2"},re=D({__name:"ShareClassCode",props:{code:{}},setup(s){const m=s,y=w(!1);return(g,o)=>{const l=a("v-btn"),p=a("v-card"),b=a("v-dialog");return _(),S(b,{modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=d=>y.value=d),"max-width":"400"},{activator:t(({props:d})=>[e(l,J({class:"self-end",variant:"flat",color:"info","prepend-icon":"mdi-share"},d),{default:t(()=>[v("Class Code")]),_:2},1040)]),default:t(()=>[e(p,{title:"Class CODE",class:"align-center pb-12 pl-12 pr-12 pt-2"},{default:t(()=>[R("div",se,r(m.code),1)]),_:1})]),_:1},8,["modelValue"])}}}),U={async getActiveTeachers(){return(await L.get("/school/teacher/activelist/")).data},async addTeacherToClass(s,m){return(await L.post(`/school/teacher/${s}/addToClass?school_class_id=${m}`)).data},async removeTeacherFromClass(s,m){return(await L.delete(`/school/teacher/${s}/removeFromClass?school_class_id=${m}`)).data}},de=D({__name:"AddTeacherFormDialog",setup(s){const m=B(),y=Q(),g=w(!1),o=w(!1),l=K(()=>m.params.id.toString()),p=w(null),{data:b,isPending:d}=M({queryKey:["school/teacher/activelist"],queryFn:async()=>await U.getActiveTeachers()}),n=async()=>{if(p.value==null)return alert("pleaseFillInAllFields");o.value=!0;try{await U.addTeacherToClass(p.value.toString(),l.value),y.invalidateQueries({queryKey:["class"]}),g.value=!1}catch(i){alert(`failedToAddTeacher: ${i}`)}finally{o.value=!1}};return j(g,i=>{i==!1&&(p.value=null)}),(i,f)=>{const c=a("v-btn"),x=a("v-card-title"),T=a("v-progress-circular"),V=a("v-select"),C=a("v-form"),F=a("v-card-text"),I=a("v-card-actions"),q=a("v-card"),A=a("v-dialog");return _(),$("div",null,[e(c,{color:"green",variant:"flat",onClick:f[0]||(f[0]=k=>g.value=!0)},{default:t(()=>[v(" + "+r("add"))]),_:1}),e(A,{modelValue:g.value,"onUpdate:modelValue":f[3]||(f[3]=k=>g.value=k),"max-width":"600"},{default:t(()=>[e(q,{class:"pa-4"},{default:t(()=>[e(x,{class:"px-2"},{default:t(()=>[v(r("addTeacher"))]),_:1}),e(F,null,{default:t(()=>[h(d)?(_(),S(T,{key:0,color:"primary",indeterminate:""})):(_(),S(C,{key:1,onSubmit:Y(n,["prevent"])},{default:t(()=>[h(b)?(_(),S(V,{key:0,modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=k=>p.value=k),items:h(b),"item-title":"name","item-value":"id",label:"Select Teacher",outlined:"",required:""},null,8,["modelValue","items"])):X("",!0)]),_:1}))]),_:1}),e(I,null,{default:t(()=>[e(c,{color:"red darken-1",variant:"text",onClick:f[2]||(f[2]=k=>g.value=!1)},{default:t(()=>[v(r("cancel"))]),_:1}),e(c,{loading:o.value,color:"green",variant:"flat",disabled:p.value==null||o.value,onClick:n},{default:t(()=>[v(r("add"))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),ie=G(de,[["__scopeId","data-v-e0b2a11d"]]),ce=D({__name:"RemoveTeacherFormDialog",props:{id:{}},setup(s){const m=B(),y=s,g=K(()=>m.params.id.toString()),o=w(!1),l=w(!1),p=Q();async function b(){l.value=!0;try{await U.removeTeacherFromClass(y.id.toString(),g.value),p.invalidateQueries({queryKey:["class"]}),o.value=!1}catch(d){alert(`failedToDeleteClass: ${d}`)}finally{l.value=!1}}return(d,n)=>{const i=a("v-btn"),f=a("v-card-title"),c=a("v-card-text"),x=a("v-card"),T=a("v-card-actions"),V=a("v-dialog");return _(),$(P,null,[e(i,{"prepend-icon":"mdi-delete",variant:"plain",loading:l.value,disabled:l.value,onClick:n[0]||(n[0]=()=>{o.value=!0})},null,8,["loading","disabled"]),e(V,{modelValue:o.value,"onUpdate:modelValue":n[3]||(n[3]=C=>o.value=C),"max-width":"600"},{default:t(()=>[e(x,{class:"pa-4"},{default:t(()=>[e(f,{class:"px-2"},{default:t(()=>[v(r("removeTeacher")+"?")]),_:1}),e(x,{class:"ma-2",color:"yellow",variant:"tonal"},{default:t(()=>[e(c,{class:"text-medium-emphasis text-lg"},{default:t(()=>[v(r("warningAllHisProgressDataWillBeRemovedPermanently"))]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(i,{color:"green darken-1",variant:"text",onClick:n[1]||(n[1]=C=>o.value=!1)},{default:t(()=>[v(r("cancel"))]),_:1}),e(i,{loading:l.value,color:"red",variant:"flat",disabled:l.value,onClick:n[2]||(n[2]=C=>b())},{default:t(()=>[v(r("remove"))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ue=D({__name:"RemoveStudentFormDialog",props:{id:{}},setup(s){const m=B(),y=s,g=K(()=>m.params.id.toString()),o=w(!1),l=w(!1),p=Q();async function b(){l.value=!0;try{await ne.removeStudentFromClass(y.id.toString(),g.value),p.invalidateQueries({queryKey:["class"]}),o.value=!1}catch(d){alert(`failedToDeleteClass: ${d}`)}finally{l.value=!1}}return(d,n)=>{const i=a("v-btn"),f=a("v-card-title"),c=a("v-card-text"),x=a("v-card"),T=a("v-card-actions"),V=a("v-dialog");return _(),$(P,null,[e(i,{"prepend-icon":"mdi-delete",variant:"plain",loading:l.value,disabled:l.value,onClick:n[0]||(n[0]=()=>{o.value=!0})},null,8,["loading","disabled"]),e(V,{modelValue:o.value,"onUpdate:modelValue":n[3]||(n[3]=C=>o.value=C),"max-width":"600"},{default:t(()=>[e(x,{class:"pa-4"},{default:t(()=>[e(f,{class:"px-2"},{default:t(()=>[v(r("removeStudent")+"?")]),_:1}),e(x,{class:"ma-2",color:"yellow",variant:"tonal"},{default:t(()=>[e(c,{class:"text-medium-emphasis text-lg"},{default:t(()=>[v(r("warningAllHisProgressDataWillBeRemovedPermanently"))]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(i,{color:"green darken-1",variant:"text",onClick:n[1]||(n[1]=C=>o.value=!1)},{default:t(()=>[v(r("cancel"))]),_:1}),e(i,{loading:l.value,color:"red",variant:"flat",disabled:l.value,onClick:n[2]||(n[2]=C=>b())},{default:t(()=>[v(r("remove"))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),E=s=>(te("data-v-b3b2d9b0"),s=s(),ae(),s),_e={key:1},ve={key:2},me=E(()=>R("br",null,null,-1)),pe=E(()=>R("br",null,null,-1)),fe=E(()=>R("div",{class:"text-body-1 mr-4"},"375xp",-1)),ge=D({__name:"ClassContentView",setup(s){const m=B(),y=oe(),{classes:g}=Z(y),o=w(m.params.id.toString()),l=w(null),{isPending:p,isError:b,data:d,error:n,refetch:i}=M({queryKey:["class",o.value],queryFn:async()=>{const c=await le.getClassByID(o.value);return l.value=c,c}});j(()=>m.params.id,c=>{o.value=c.toString(),i()});function f(c){ee.replace({path:`/dashboard/class/${c}`})}return(c,x)=>{const T=a("v-select"),V=a("v-skeleton-loader"),C=a("v-divider"),F=a("v-avatar"),I=a("v-list-item-title"),q=a("v-list-item"),A=a("v-card"),k=a("v-btn"),O=a("RouterLink"),z=a("v-col");return _(),S(z,{style:{"min-width":"300px","max-width":"100%"}},{default:t(()=>{var N;return[e(T,{modelValue:l.value,"onUpdate:modelValue":[x[0]||(x[0]=u=>l.value=u),f],class:"d-inline-flex",label:"Class",items:h(g),"item-title":"name","item-value":"id"},null,8,["modelValue","items"]),h(p)?(_(),S(V,{key:0,type:"list-item-two-line"})):h(b)?(_(),$("div",_e,r((N=h(n))==null?void 0:N.message),1)):(_(),$("div",ve,[me,e(A,{title:"Teachers",class:"pa-4 border-sm rounded-lg",variant:"flat"},{append:t(()=>[e(ie)]),default:t(()=>[e(C,{class:"border-opacity-100 my-2",color:"error"}),(_(!0),$(P,null,W(h(d).teachers,u=>(_(),S(q,{key:u.id,color:"primary",rounded:"shaped"},{prepend:t(()=>[e(F,{color:"grey",image:u.image||""},null,8,["image"])]),append:t(()=>[e(ce,{id:u.id},null,8,["id"])]),default:t(()=>[e(I,{textContent:r(u.name)},null,8,["textContent"])]),_:2},1024))),128))]),_:1}),pe,e(A,{title:"Students",class:"pa-4 border-sm rounded-lg",variant:"flat"},{append:t(()=>{var u,H;return[e(O,{to:{name:"students-progress-view",params:{id:(u=h(d))==null?void 0:u.id}}},{default:t(()=>[e(k,{class:"self-end mr-4",variant:"flat",color:"warning","prepend-icon":"mdi-stairs"},{default:t(()=>[v("Progress")]),_:1})]),_:1},8,["to"]),e(re,{code:((H=l.value)==null?void 0:H.code)??""},null,8,["code"])]}),default:t(()=>[e(C,{class:"border-opacity-100 my-2",color:"error"}),(_(!0),$(P,null,W(h(d).students,u=>(_(),S(q,{key:u.id,color:"primary",rounded:"shaped"},{prepend:t(()=>[e(F,{color:"grey",image:u.image||""},null,8,["image"])]),append:t(()=>[fe,e(k,{to:{name:"student-profile-view",params:{id:u.id}},class:"mx-4",variant:"tonal","append-icon":"mdi-page-next-outline"},{default:t(()=>[v("profile")]),_:2},1032,["to"]),e(ue,{id:u.id},null,8,["id"])]),default:t(()=>[e(I,{textContent:r(u.name)},null,8,["textContent"])]),_:2},1024))),128))]),_:1})]))]}),_:1})}}}),ke=G(ge,[["__scopeId","data-v-b3b2d9b0"]]);export{ke as default};
