import{u as K,a as L}from"./useQuery-D3pHsC49.js";import{S as F}from"./StudentService-fKVCG4Ib.js";import{_ as O}from"./AvatarPlaceholder.vue_vue_type_script_setup_true_lang-DqT-h7sm.js";import{S as M}from"./SkillsDiagram-BVbRER7o.js";import{_ as W}from"./TokenCard.vue_vue_type_script_setup_true_lang-DZuxFK25.js";import{d as R,u as Q,k as N,r as S,b as a,o as s,h as p,w as t,e,a as f,c as h,t as m,i as P,f as u,p as B,n as Y,g as w,F as q,_ as T,l as G,m as H,v as J}from"./index-CmTIu2SI.js";import{P as X}from"./ProjectCard-DXilTpx0.js";import"./api-client-_2bmHwbl.js";import"./base-url-qR72hEjy.js";const Z={class:"relative image-container"},ee={key:0,class:"absolute top-0 left-0 bg-yellow-400 text-black px-4 py-1 text-xs font-semibold"},te={class:"text-h5"},ae={key:0},ne=R({__name:"CourseProgressCard",props:{course:{}},setup(V){const k=Q(),c=V,n=N(()=>c.course),g=N(()=>k.params.id),_=S([]);function d(v,b){return b?"bg-orange-darken-2":v=="completed"?"bg-green-darken-1":v=="attempted"?"bg-red-darken-1":v=="accessed"?"bg-grey-lighten-1":"bg-grey-lighten-2"}const{isPending:i,data:$}=K({queryKey:["skill",n.value.id,g.value],queryFn:async()=>{const v=await F.getCourseInfoByIdStudentId(n.value.id.toString(),g.value.toString());for(const b of v.modules)for(const o of b.topics){const l=await F.getTopicByIdStudentId(o.id.toString(),g.value.toString());_.value=[..._.value,...l.steps]}return v},refetchOnWindowFocus:!1});return(v,b)=>{const o=a("v-img"),l=a("v-col"),x=a("v-row"),y=a("v-tooltip"),j=a("v-btn"),U=a("v-sheet"),I=a("v-card");return s(),p(I,{class:"pa-2 border-sm rounded-lg",variant:"flat",disabled:n.value.status!="green"},{default:t(()=>[e(x,null,{default:t(()=>[e(l,{cols:"12",sm:"5",class:"justify-start align-start"},{default:t(()=>[e(x,null,{default:t(()=>[f("div",Z,[e(o,{height:"100",width:"175",src:n.value.cover_image,alt:n.value.name+" Image",cover:""},null,8,["src","alt"]),n.value.status!="green"?(s(),h("div",ee,m(v.$t("comingSoon")),1)):P("",!0)]),e(l,{class:"justify-center align-center pl-4"},{default:t(()=>[f("div",te,m(n.value.name),1),f("div",null,m(n.value.description),1),f("div",null,m(`${n.value.completed_steps_count} / ${n.value.total_steps_count}`),1)]),_:1})]),_:1})]),_:1}),e(l,{cols:"12",sm:"7",class:"d-flex flex-column justify-center align-center"},{default:t(()=>[u(i)?(s(),h("div",ae,"Pending...")):u($)?(s(),p(U,{key:1,class:"d-flex align-content-start flex-wrap gap-1"},{default:t(()=>[(s(!0),h(q,null,B(_.value,r=>{var D;return s(),p(j,{to:`/course/${n.value.id}/topic/${r.parent_id}/step/${r.id}?dashboard_topic_id=${r.parent_id}&dashboard_step_id=${r.id}&dashboard_step_order=${r.order}`,key:r.id,class:Y(["small-btn ma-0 pa-0 w-3 h-3",d(r.progress,((D=n.value.last_accessed_topic.last_accessed_step)==null?void 0:D.id)==r.id)]),variant:"flat"},{default:t(()=>[e(y,{activator:"parent",location:"top"},{default:t(()=>[w(m(`${r.id}: ${r.name}`),1)]),_:2},1024)]),_:2},1032,["to","class"])}),128))]),_:1})):P("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])}}}),le=T(ne,[["__scopeId","data-v-75e8f92a"]]),oe={class:"d-flex"},se=R({__name:"UpdateStudentFormDialog",props:{item:{}},setup(V){const{t:k}=G(),c=V,n=S(!1),g=S(!1),_=L(),d=S({name:c.item.name,image:null}),i=S(null);i.value=c.item.image;const $=o=>{const l=o.target;l.files&&l.files[0]&&(d.value.image=l.files[0],i.value=URL.createObjectURL(l.files[0]))},v=N(()=>d.value.name),b=async()=>{if(!v.value)return alert(k("pleaseFillInAllFields"));const o=new FormData;o.append("name",d.value.name),d.value.image!=null&&o.append("image",d.value.image),g.value=!0;try{await F.updateStudent(c.item.id,o),await _.invalidateQueries({queryKey:["school/student/profile"]}),n.value=!1}catch(l){alert(`${k("failedToUpdateStudent")}: ${l}`)}finally{g.value=!1}};return H(n,o=>{o&&(d.value.name=c.item.name,d.value.image=null,i.value=c.item.image)}),(o,l)=>{const x=a("v-btn"),y=a("v-card-title"),j=a("v-text-field"),U=a("v-file-input"),I=a("v-img"),r=a("v-form"),D=a("v-card-text"),A=a("v-card-actions"),E=a("v-card"),z=a("v-dialog");return s(),h(q,null,[e(x,{class:"text-none py-2","prepend-icon":"mdi-pencil",variant:"plain",onClick:l[0]||(l[0]=C=>n.value=!0)},{default:t(()=>[w(m(o.$t("Edit profile")),1)]),_:1}),e(z,{modelValue:n.value,"onUpdate:modelValue":l[4]||(l[4]=C=>n.value=C),"max-width":"600"},{default:t(()=>[e(E,{class:"pa-4"},{default:t(()=>[e(y,{class:"px-2"},{default:t(()=>[w(m(o.$t("updateStudent")),1)]),_:1}),e(D,null,{default:t(()=>[e(r,{onSubmit:J(b,["prevent"])},{default:t(()=>[e(j,{modelValue:d.value.name,"onUpdate:modelValue":l[1]||(l[1]=C=>d.value.name=C),type:"text",density:"compact",label:o.$t("name"),placeholder:o.$t("nameSurname"),"prepend-inner-icon":"mdi-account-outline",variant:"outlined",required:""},null,8,["modelValue","label","placeholder"]),f("div",oe,[e(U,{modelValue:d.value.image,"onUpdate:modelValue":l[2]||(l[2]=C=>d.value.image=C),"max-width":"100%",variant:"outlined",accept:"image/png, image/jpeg, image/bmp",label:o.$t("avatar"),placeholder:"Pick an avatar","prepend-icon":"mdi-camera",onChange:$,counter:"",required:""},null,8,["modelValue","label"]),i.value?(s(),p(I,{key:0,src:i.value,"max-width":"60","max-height":"60",class:"pa-0 ma-0"},null,8,["src"])):P("",!0)])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(x,{color:"red darken-1",variant:"text",onClick:l[3]||(l[3]=C=>n.value=!1)},{default:t(()=>[w(m(o.$t("cancel")),1)]),_:1}),e(x,{loading:g.value,color:"primary",variant:"flat",disabled:!v.value||g.value,onClick:b},{default:t(()=>[w(m(o.$t("save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ie=T(se,[["__scopeId","data-v-72b6b4fb"]]),re=R({__name:"ResetStudentPassFormDialog",props:{id:{}},setup(V){const k=V,c=S(!1),n=S(!1),g=L();async function _(){n.value=!0;try{const d=await F.resetStudentPassword(k.id.toString());g.invalidateQueries({queryKey:["class"]}),c.value=!1,alert(`New password is: ${d.new_password}`)}catch(d){alert(`failedToResetPassword: ${d}`)}finally{n.value=!1}}return(d,i)=>{const $=a("v-btn"),v=a("v-card-title"),b=a("v-card-text"),o=a("v-card"),l=a("v-card-actions"),x=a("v-dialog");return s(),h(q,null,[e($,{class:"text-none","prepend-icon":"mdi-lock-reset",variant:"plain",loading:n.value,disabled:n.value,onClick:i[0]||(i[0]=()=>{c.value=!0})},{default:t(()=>[w("Reset password")]),_:1},8,["loading","disabled"]),e(x,{modelValue:c.value,"onUpdate:modelValue":i[3]||(i[3]=y=>c.value=y),"max-width":"600"},{default:t(()=>[e(o,{class:"pa-4"},{default:t(()=>[e(v,{class:"px-2"},{default:t(()=>[w(m("Are you sure you want to reset password?"))]),_:1}),e(o,{class:"ma-2",color:"yellow",variant:"tonal"},{default:t(()=>[e(b,{class:"text-medium-emphasis text-lg"},{default:t(()=>[w(m("You will be given a new generated password for the student"))]),_:1})]),_:1}),e(l,null,{default:t(()=>[e($,{color:"green darken-1",variant:"text",onClick:i[1]||(i[1]=y=>c.value=!1)},{default:t(()=>[w(m("cancel"))]),_:1}),e($,{loading:n.value,color:"red",variant:"flat",disabled:n.value,onClick:i[2]||(i[2]=y=>_())},{default:t(()=>[w(m("reset"))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),de=f("div",{class:"text-h5 pb-6"},"Student Profile",-1),ce={key:1},ue={key:2},_e={class:"text-h5 pt-4"},me={class:"text-body"},ve={class:"flex pt-2"},pe=f("div",{class:"text-h4"},"375xp",-1),fe=f("br",null,null,-1),ge=f("br",null,null,-1),ye={class:"d-flex flex-wrap justify-center align-center gap-2"},Ie=R({__name:"StudentProfileView",setup(V){const k=Q(),c=S(k.params.id.toString()),{isPending:n,isError:g,data:_,error:d}=K({queryKey:["school/student/profile",c.value],queryFn:()=>F.getStudentProfile(c.value)}),{data:i}=K({queryKey:["school/student",c.value],queryFn:()=>F.getStudentById(c.value)});return($,v)=>{const b=a("v-skeleton-loader"),o=a("v-avatar"),l=a("v-icon"),x=a("v-btn"),y=a("v-col"),j=a("v-row"),U=a("v-card");return s(),p(y,{style:{"min-width":"300px","max-width":"100%"}},{default:t(()=>{var I;return[de,u(n)?(s(),p(b,{key:0,type:"list-item-two-line"})):u(g)?(s(),h("div",ce,m((I=u(d))==null?void 0:I.message),1)):u(_)?(s(),h("div",ue,[e(U,{class:"pa-6 border-sm rounded-lg",variant:"flat"},{default:t(()=>[e(j,null,{default:t(()=>[e(y,{cols:"12",sm:"4",class:"d-flex flex-column justify-center align-center"},{default:t(()=>[u(_).image!=null?(s(),p(o,{key:0,image:u(_).image,size:"120"},null,8,["image"])):(s(),p(O,{key:1,big:!0})),f("div",_e,m(u(_).name),1),f("div",me,m(u(_).login),1),f("div",ve,[e(x,{style:{"min-width":"0px",visibility:"hidden"},class:"pa-0 h-auto",variant:"flat",density:"compact"},{default:t(()=>[e(l,{color:"info",icon:"mdi-information"})]),_:1}),pe,e(x,{style:{"min-width":"0px"},class:"pa-0",variant:"flat",density:"compact"},{default:t(()=>[e(l,{color:"info",icon:"mdi-information"})]),_:1})]),u(i)?(s(),p(ie,{key:2,item:u(i)},null,8,["item"])):P("",!0),u(i)?(s(),p(re,{key:3,id:u(i).id},null,8,["id"])):P("",!0)]),_:1}),e(y,{cols:"12",sm:"4",class:"d-flex flex-column justify-center align-center"},{default:t(()=>[e(M)]),_:1}),e(y,{cols:"12",sm:"4",class:"d-flex flex-wrap justify-center align-center"},{default:t(()=>[(s(!0),h(q,null,B(u(_).artisan_tokens,r=>(s(),p(W,{class:"ma-2",key:r.id,token:r,small:!0},null,8,["token"]))),128))]),_:1})]),_:1})]),_:1}),fe,(s(!0),h(q,null,B(u(_).courses,r=>(s(),p(le,{key:r.id,course:r,class:"mb-2"},null,8,["course"]))),128)),ge,f("div",ye,[(s(!0),h(q,null,B(u(_).projects,r=>(s(),p(X,{key:r.id,project:r,flat:!0},null,8,["project"]))),128))])])):P("",!0)]}),_:1})}}});export{Ie as default};
